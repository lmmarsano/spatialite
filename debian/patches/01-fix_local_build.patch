From: David Paleino <dapal@debian.org>
Subject: fix local build issues
Origin: vendor
Forwarded: not-needed

---
 spatialite-tools/Makefile.am  |    7 ++--
 spatialite-tools/Makefile.in  |    7 ++--
 spatialite-tools/configure    |   71 +-----------------------------------------
 spatialite-tools/configure.ac |    3 +
 4 files changed, 14 insertions(+), 74 deletions(-)

--- spatialite.orig/spatialite-tools/Makefile.am
+++ spatialite/spatialite-tools/Makefile.am
@@ -1,7 +1,9 @@
 ACLOCAL_AMFLAGS = -I m4
 
 AM_CFLAGS = -D_LARGE_FILE=1 -D_FILE_OFFSET_BITS=64 \
-	-D_LARGEFILE_SOURCE=1 @LIBSPATIALITE_CFLAGS@
+	-D_LARGEFILE_SOURCE=1 @LIBSPATIALITE_CFLAGS@ \
+	-L../libspatialite/src/.libs/ \
+	-I../libspatialite/src/headers/
 
 bin_PROGRAMS = spatialite \
 	spatialite_tool \
@@ -32,7 +34,8 @@ spatialite_osm_raw_LDADD = @LIBSPATIALIT
 spatialite_gml_LDADD = @LIBSPATIALITE_LIBS@ \
 	-lexpat 
 spatialite_LDADD = @LIBSPATIALITE_LIBS@ \
-	@READLINE_LIBS@
+	@READLINE_LIBS@ \
+	-lfreexl
 LDADD = @LIBSPATIALITE_LIBS@ 
 
 EXTRA_DIST = makefile.vc nmake.opt \
--- spatialite.orig/spatialite-tools/Makefile.in
+++ spatialite/spatialite-tools/Makefile.in
@@ -252,7 +252,9 @@ top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
 ACLOCAL_AMFLAGS = -I m4
 AM_CFLAGS = -D_LARGE_FILE=1 -D_FILE_OFFSET_BITS=64 \
-	-D_LARGEFILE_SOURCE=1 @LIBSPATIALITE_CFLAGS@
+	-D_LARGEFILE_SOURCE=1 @LIBSPATIALITE_CFLAGS@ \
+	-L../libspatialite/src/.libs/ \
+	-I../libspatialite/src/headers/
 
 INCLUDES = @CFLAGS@
 spatialite_SOURCES = shell.c shapefiles.c
@@ -274,7 +276,8 @@ spatialite_gml_LDADD = @LIBSPATIALITE_LI
 	-lexpat 
 
 spatialite_LDADD = @LIBSPATIALITE_LIBS@ \
-	@READLINE_LIBS@
+	@READLINE_LIBS@ \
+	-lfreexl
 
 LDADD = @LIBSPATIALITE_LIBS@ 
 EXTRA_DIST = makefile.vc nmake.opt \
--- spatialite.orig/spatialite-tools/configure
+++ spatialite/spatialite-tools/configure
@@ -16710,75 +16710,6 @@ $as_echo "no" >&6; }
 fi
 
 pkg_failed=no
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for LIBSPATIALITE" >&5
-$as_echo_n "checking for LIBSPATIALITE... " >&6; }
-
-if test -n "$LIBSPATIALITE_CFLAGS"; then
-    pkg_cv_LIBSPATIALITE_CFLAGS="$LIBSPATIALITE_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"spatialite\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "spatialite") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then
-  pkg_cv_LIBSPATIALITE_CFLAGS=`$PKG_CONFIG --cflags "spatialite" 2>/dev/null`
-else
-  pkg_failed=yes
-fi
- else
-    pkg_failed=untried
-fi
-if test -n "$LIBSPATIALITE_LIBS"; then
-    pkg_cv_LIBSPATIALITE_LIBS="$LIBSPATIALITE_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"spatialite\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "spatialite") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then
-  pkg_cv_LIBSPATIALITE_LIBS=`$PKG_CONFIG --libs "spatialite" 2>/dev/null`
-else
-  pkg_failed=yes
-fi
- else
-    pkg_failed=untried
-fi
-
-
-
-if test $pkg_failed = yes; then
-   	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-
-if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
-        _pkg_short_errors_supported=yes
-else
-        _pkg_short_errors_supported=no
-fi
-        if test $_pkg_short_errors_supported = yes; then
-	        LIBSPATIALITE_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "spatialite" 2>&1`
-        else
-	        LIBSPATIALITE_PKG_ERRORS=`$PKG_CONFIG --print-errors "spatialite" 2>&1`
-        fi
-	# Put the nasty error message in config.log where it belongs
-	echo "$LIBSPATIALITE_PKG_ERRORS" >&5
-
-	as_fn_error $? "'libspatialite' is required but it doesn't seems to be installed on this system." "$LINENO" 5
-elif test $pkg_failed = untried; then
-     	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-	as_fn_error $? "'libspatialite' is required but it doesn't seems to be installed on this system." "$LINENO" 5
-else
-	LIBSPATIALITE_CFLAGS=$pkg_cv_LIBSPATIALITE_CFLAGS
-	LIBSPATIALITE_LIBS=$pkg_cv_LIBSPATIALITE_LIBS
-        { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-$as_echo "yes" >&6; }
-
-fi
-
-pkg_failed=no
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for LIBFREEXL" >&5
 $as_echo_n "checking for LIBFREEXL... " >&6; }
 
@@ -16846,6 +16777,8 @@ else
 $as_echo "yes" >&6; }
 
 fi
+LIBSPATIALITE_CFLAGS=
+LIBSPATIALITE_LIBS="-lspatialite -lsqlite3"
 
 
 
--- spatialite.orig/spatialite-tools/configure.ac
+++ spatialite/spatialite-tools/configure.ac
@@ -74,8 +74,9 @@ AC_CHECK_LIB(expat,XML_ParserCreate,,AC_
 AC_CHECK_LIB(proj,pj_init_plus,,AC_MSG_ERROR(['libproj' is required but it doesn't seems to be installed on this system.]),-lm)
 AC_CHECK_LIB(geos_c,GEOSTopologyPreserveSimplify,,AC_MSG_ERROR(['libgeos_c' is required but it doesn't seems to be installed on this system.]),-lm -lgeos)
 
-PKG_CHECK_MODULES([LIBSPATIALITE], [spatialite], , AC_MSG_ERROR(['libspatialite' is required but it doesn't seems to be installed on this system.]))
 PKG_CHECK_MODULES([LIBFREEXL], [freexl], , AC_MSG_ERROR(['libfreexl' is required but it doesn't seems to be installed on this system.]))
+LIBSPATIALITE_CFLAGS=
+LIBSPATIALITE_LIBS="-lspatialite -lsqlite3"
 AC_SUBST(LIBSPATIALITE_CFLAGS)
 AC_SUBST(LIBSPATIALITE_LIBS)
 
