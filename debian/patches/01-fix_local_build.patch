From: David Paleino <dapal@debian.org>
Subject: fix local build issues
Origin: vendor
Forwarded: not-needed

---
 spatialite-tools/Makefile.am  |    6 ++-
 spatialite-tools/Makefile.in  |   25 +++++++++-----
 spatialite-tools/configure    |   71 +-----------------------------------------
 spatialite-tools/configure.ac |    3 +
 4 files changed, 24 insertions(+), 81 deletions(-)

--- spatialite.orig/spatialite-tools/Makefile.am
+++ spatialite/spatialite-tools/Makefile.am
@@ -1,7 +1,8 @@
 ACLOCAL_AMFLAGS = -I m4
 
 AM_CFLAGS = -D_LARGE_FILE=1 -D_FILE_OFFSET_BITS=64 \
-	-D_LARGEFILE_SOURCE=1 @LIBSPATIALITE_CFLAGS@
+	-D_LARGEFILE_SOURCE=1 @LIBSPATIALITE_CFLAGS@ \
+	-L../libspatialite/src/.libs/
 
 bin_PROGRAMS = spatialite \
 	spatialite_tool \
@@ -32,7 +33,8 @@ spatialite_osm_raw_LDADD = @LIBSPATIALIT
 spatialite_gml_LDADD = @LIBSPATIALITE_LIBS@ \
 	-lexpat 
 spatialite_LDADD = @LIBSPATIALITE_LIBS@ \
-	@READLINE_LIBS@
+	@READLINE_LIBS@ \
+	-lfreexl
 LDADD = @LIBSPATIALITE_LIBS@ 
 
 EXTRA_DIST = makefile.vc nmake.opt \
--- spatialite.orig/spatialite-tools/Makefile.in
+++ spatialite/spatialite-tools/Makefile.in
@@ -42,9 +42,13 @@ bin_PROGRAMS = spatialite$(EXEEXT) spati
 subdir = .
 DIST_COMMON = README $(am__configure_deps) $(srcdir)/Makefile.am \
 	$(srcdir)/Makefile.in $(top_srcdir)/configure AUTHORS COPYING \
-	config.guess config.sub depcomp install-sh ltmain.sh missing
+	ChangeLog INSTALL NEWS config.guess config.sub depcomp \
+	install-sh ltmain.sh missing
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
-am__aclocal_m4_deps = $(top_srcdir)/configure.ac
+am__aclocal_m4_deps = $(top_srcdir)/m4/libtool.m4 \
+	$(top_srcdir)/m4/ltoptions.m4 $(top_srcdir)/m4/ltsugar.m4 \
+	$(top_srcdir)/m4/ltversion.m4 $(top_srcdir)/m4/lt~obsolete.m4 \
+	$(top_srcdir)/configure.ac
 am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
 	$(ACLOCAL_M4)
 am__CONFIG_DISTCLEAN_FILES = config.status config.cache config.log \
@@ -172,6 +176,7 @@ LN_S = @LN_S@
 LTLIBOBJS = @LTLIBOBJS@
 MAINT = @MAINT@
 MAKEINFO = @MAKEINFO@
+MANIFEST_TOOL = @MANIFEST_TOOL@
 MKDIR_P = @MKDIR_P@
 NM = @NM@
 NMEDIT = @NMEDIT@
@@ -201,6 +206,7 @@ abs_builddir = @abs_builddir@
 abs_srcdir = @abs_srcdir@
 abs_top_builddir = @abs_top_builddir@
 abs_top_srcdir = @abs_top_srcdir@
+ac_ct_AR = @ac_ct_AR@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_DUMPBIN = @ac_ct_DUMPBIN@
@@ -234,7 +240,6 @@ libdir = @libdir@
 libexecdir = @libexecdir@
 localedir = @localedir@
 localstatedir = @localstatedir@
-lt_ECHO = @lt_ECHO@
 mandir = @mandir@
 mkdir_p = @mkdir_p@
 oldincludedir = @oldincludedir@
@@ -252,7 +257,8 @@ top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
 ACLOCAL_AMFLAGS = -I m4
 AM_CFLAGS = -D_LARGE_FILE=1 -D_FILE_OFFSET_BITS=64 \
-	-D_LARGEFILE_SOURCE=1 @LIBSPATIALITE_CFLAGS@
+	-D_LARGEFILE_SOURCE=1 @LIBSPATIALITE_CFLAGS@ \
+	-L../libspatialite/src/.libs/
 
 INCLUDES = @CFLAGS@
 spatialite_SOURCES = shell.c shapefiles.c
@@ -274,7 +280,8 @@ spatialite_gml_LDADD = @LIBSPATIALITE_LI
 	-lexpat 
 
 spatialite_LDADD = @LIBSPATIALITE_LIBS@ \
-	@READLINE_LIBS@
+	@READLINE_LIBS@ \
+	-lfreexl
 
 LDADD = @LIBSPATIALITE_LIBS@ 
 EXTRA_DIST = makefile.vc nmake.opt \
@@ -293,15 +300,15 @@ $(srcdir)/Makefile.in: @MAINTAINER_MODE_
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
 	    *$$dep*) \
-	      echo ' cd $(srcdir) && $(AUTOMAKE) --foreign'; \
-	      $(am__cd) $(srcdir) && $(AUTOMAKE) --foreign \
+	      echo ' cd $(srcdir) && $(AUTOMAKE) --gnu'; \
+	      $(am__cd) $(srcdir) && $(AUTOMAKE) --gnu \
 		&& exit 0; \
 	      exit 1;; \
 	  esac; \
 	done; \
-	echo ' cd $(top_srcdir) && $(AUTOMAKE) --foreign Makefile'; \
+	echo ' cd $(top_srcdir) && $(AUTOMAKE) --gnu Makefile'; \
 	$(am__cd) $(top_srcdir) && \
-	  $(AUTOMAKE) --foreign Makefile
+	  $(AUTOMAKE) --gnu Makefile
 .PRECIOUS: Makefile
 Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status
 	@case '$?' in \
--- spatialite.orig/spatialite-tools/configure
+++ spatialite/spatialite-tools/configure
@@ -16710,75 +16710,6 @@ $as_echo "no" >&6; }
 fi
 
 pkg_failed=no
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for LIBSPATIALITE" >&5
-$as_echo_n "checking for LIBSPATIALITE... " >&6; }
-
-if test -n "$LIBSPATIALITE_CFLAGS"; then
-    pkg_cv_LIBSPATIALITE_CFLAGS="$LIBSPATIALITE_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"spatialite\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "spatialite") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then
-  pkg_cv_LIBSPATIALITE_CFLAGS=`$PKG_CONFIG --cflags "spatialite" 2>/dev/null`
-else
-  pkg_failed=yes
-fi
- else
-    pkg_failed=untried
-fi
-if test -n "$LIBSPATIALITE_LIBS"; then
-    pkg_cv_LIBSPATIALITE_LIBS="$LIBSPATIALITE_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"spatialite\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "spatialite") 2>&5
-  ac_status=$?
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then
-  pkg_cv_LIBSPATIALITE_LIBS=`$PKG_CONFIG --libs "spatialite" 2>/dev/null`
-else
-  pkg_failed=yes
-fi
- else
-    pkg_failed=untried
-fi
-
-
-
-if test $pkg_failed = yes; then
-   	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-
-if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
-        _pkg_short_errors_supported=yes
-else
-        _pkg_short_errors_supported=no
-fi
-        if test $_pkg_short_errors_supported = yes; then
-	        LIBSPATIALITE_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors "spatialite" 2>&1`
-        else
-	        LIBSPATIALITE_PKG_ERRORS=`$PKG_CONFIG --print-errors "spatialite" 2>&1`
-        fi
-	# Put the nasty error message in config.log where it belongs
-	echo "$LIBSPATIALITE_PKG_ERRORS" >&5
-
-	as_fn_error $? "'libspatialite' is required but it doesn't seems to be installed on this system." "$LINENO" 5
-elif test $pkg_failed = untried; then
-     	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-	as_fn_error $? "'libspatialite' is required but it doesn't seems to be installed on this system." "$LINENO" 5
-else
-	LIBSPATIALITE_CFLAGS=$pkg_cv_LIBSPATIALITE_CFLAGS
-	LIBSPATIALITE_LIBS=$pkg_cv_LIBSPATIALITE_LIBS
-        { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-$as_echo "yes" >&6; }
-
-fi
-
-pkg_failed=no
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for LIBFREEXL" >&5
 $as_echo_n "checking for LIBFREEXL... " >&6; }
 
@@ -16846,6 +16777,8 @@ else
 $as_echo "yes" >&6; }
 
 fi
+LIBSPATIALITE_CFLAGS=
+LIBSPATIALITE_LIBS=-lspatialite -lsqlite3
 
 
 
--- spatialite.orig/spatialite-tools/configure.ac
+++ spatialite/spatialite-tools/configure.ac
@@ -74,8 +74,9 @@ AC_CHECK_LIB(expat,XML_ParserCreate,,AC_
 AC_CHECK_LIB(proj,pj_init_plus,,AC_MSG_ERROR(['libproj' is required but it doesn't seems to be installed on this system.]),-lm)
 AC_CHECK_LIB(geos_c,GEOSTopologyPreserveSimplify,,AC_MSG_ERROR(['libgeos_c' is required but it doesn't seems to be installed on this system.]),-lm -lgeos)
 
-PKG_CHECK_MODULES([LIBSPATIALITE], [spatialite], , AC_MSG_ERROR(['libspatialite' is required but it doesn't seems to be installed on this system.]))
 PKG_CHECK_MODULES([LIBFREEXL], [freexl], , AC_MSG_ERROR(['libfreexl' is required but it doesn't seems to be installed on this system.]))
+LIBSPATIALITE_CFLAGS=
+LIBSPATIALITE_LIBS=-lspatialite -lsqlite3
 AC_SUBST(LIBSPATIALITE_CFLAGS)
 AC_SUBST(LIBSPATIALITE_LIBS)
 
